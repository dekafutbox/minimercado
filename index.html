<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minimercado</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <script src="https://unpkg.com/html5-qrcode"></script>
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
    
    <style>
        body { background-color: #f4f6f9; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        .card-summary { border: none; border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .text-debt { color: #dc3545; font-weight: bold; }
        .text-credit { color: #198754; font-weight: bold; }
        .product-card { cursor: pointer; transition: 0.2s; border: 1px solid #ddd; height: 100%; background: white; }
        .product-card:hover { transform: translateY(-3px); border-color: #0d6efd; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
        #reader, #readerCart { width: 100%; border-radius: 10px; overflow: hidden; display: none; margin-bottom: 10px; }
        .pix-preview { max-width: 180px; border-radius: 10px; border: 2px dashed #ccc; padding: 10px; margin: 0 auto; }
        #pixDisplayImg { max-width: 100%; display: none; }
        .hist-item { border-left: 4px solid #dee2e6; margin-bottom: 10px; padding-left: 10px; }
        .hist-buy { border-left-color: #dc3545; }
        .hist-pay { border-left-color: #198754; }
        .search-select-box { position: relative; }
    </style>
</head>
<body>

<div class="container py-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h3><i class="bi bi-shop"></i> Minimercado</h3>
        <button onclick="resetSystem()" class="btn btn-sm btn-outline-danger">Zerar Sistema</button>
    </div>

    <ul class="nav nav-pills mb-4 justify-content-center" id="pills-tab">
        <li class="nav-item"><button class="nav-link active" data-bs-toggle="pill" data-bs-target="#pills-venda">üõí Venda</button></li>
        <li class="nav-item"><button class="nav-link" data-bs-toggle="pill" data-bs-target="#pills-clientes">üë• Clientes</button></li>
        <li class="nav-item"><button class="nav-link" data-bs-toggle="pill" data-bs-target="#pills-estoque">üì¶ Estoque</button></li>
        <li class="nav-item"><button class="nav-link" data-bs-toggle="pill" data-bs-target="#pills-config">‚öôÔ∏è Conta/Pix</button></li>
    </ul>

    <div class="tab-content">
        
        <div class="tab-pane fade show active" id="pills-venda">
            <div class="row">
                <div class="col-md-7 mb-3">
                    <div class="card card-summary p-3">
                        <input type="text" id="searchProduct" class="form-control mb-3" placeholder="üîç Buscar produto..." onkeyup="renderPOSProducts()">
                        <div class="row g-2" id="posProductList"></div>
                    </div>
                </div>
                <div class="col-md-5">
                    <div class="card card-summary p-3 bg-white">
                        <h5 class="d-flex justify-content-between">Carrinho <span class="badge bg-primary" id="cartCount">0</span></h5>
                        <div class="table-responsive" style="max-height: 200px;"><table class="table table-sm"><tbody id="cartTableBody"></tbody></table></div>
                        <hr>
                        <div class="d-flex justify-content-between fs-4 fw-bold">
                            <span>Total:</span> <span id="cartTotalDisplay">R$ 0,00</span>
                        </div>
                        <div id="feeAlert" class="text-danger small mb-2" style="display:none;"></div>
                        
                        <div class="mt-3">
                            <label class="form-label small fw-bold">Selecionar Cliente</label>
                            <div id="readerCart"></div>
                            <div class="input-group mb-2">
                                <span class="input-group-text"><i class="bi bi-search"></i></span>
                                <input type="text" id="customerSearchInput" class="form-control" placeholder="Pesquisar nome..." onkeyup="filterCartCustomers()">
                                <button class="btn btn-outline-dark" onclick="startScanner('cart')" title="Cadastrar novo via QR"><i class="bi bi-qr-code-scan"></i></button>
                            </div>
                            <div class="search-select-box">
                                <select class="form-select mb-2" id="saleCustomer" onchange="syncSearchInput()"></select>
                            </div>

                            <label class="form-label small fw-bold">Pagamento</label>
                            <select class="form-select mb-3" id="paymentMethod" onchange="updateTotalWithFees()">
                                <option value="Dinheiro">Dinheiro</option>
                                <option value="Pix">Pix</option>
                                <option value="Cart√£o">Cart√£o (Cr√©dito/D√©bito)</option>
                                <option value="Fiado">Fiado (Na Conta)</option>
                            </select>
                            
                            <button id="btnShowPix" class="btn btn-info w-100 mb-2" style="display:none;" data-bs-toggle="modal" data-bs-target="#pixModal">
                                <i class="bi bi-qr-code"></i> Abrir QR Code Pix
                            </button>

                            <div id="cashInputDiv" class="mb-3" style="display:none;">
                                <input type="number" class="form-control" id="cashReceived" placeholder="Valor Recebido (R$)">
                            </div>
                            <button onclick="finalizeSale()" class="btn btn-success w-100 btn-lg fw-bold">Finalizar Venda</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="tab-pane fade" id="pills-clientes">
            <div class="row">
                <div class="col-md-4 mb-3">
                    <div class="card card-summary p-3 mb-3">
                        <h5>Novo Cliente</h5>
                        <div id="reader"></div>
                        <div class="input-group mb-2">
                            <input type="text" id="newClientName" class="form-control" placeholder="Nome">
                            <button class="btn btn-outline-dark" onclick="startScanner('manual')"><i class="bi bi-qr-code-scan"></i></button>
                        </div>
                        <input type="text" id="newClientPhone" class="form-control mb-2" placeholder="Telefone/WhatsApp">
                        <button onclick="addCustomer()" class="btn btn-primary w-100">Cadastrar</button>
                    </div>
                    <div class="card card-summary p-3 bg-light text-center">
                        <label for="excelInput" class="btn btn-sm btn-outline-success w-100">Importar Clientes (Excel)</label>
                        <input type="file" id="excelInput" style="display:none" onchange="importCustomers(this)">
                    </div>
                </div>
                <div class="col-md-8">
                    <div class="card card-summary p-3">
                        <div class="input-group mb-3">
                            <input type="text" id="searchClient" class="form-control" placeholder="Filtrar por nome..." onkeyup="renderCustomers()">
                            <button class="btn btn-outline-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown" id="activeFilterLabel">
                                <i class="bi bi-funnel"></i> Todos
                            </button>
                            <ul class="dropdown-menu dropdown-menu-end">
                                <li><a class="dropdown-item" href="#" onclick="setBalanceFilter('all')">Todos</a></li>
                                <li><a class="dropdown-item" href="#" onclick="setBalanceFilter('negative')"><i class="bi bi-dash-circle text-danger"></i> Devedores</a></li>
                                <li><a class="dropdown-item" href="#" onclick="setBalanceFilter('positive')"><i class="bi bi-plus-circle text-success"></i> Saldo Positivo</a></li>
                            </ul>
                        </div>
                        <div class="table-responsive"><table class="table table-hover">
                            <thead><tr><th>Nome / Tel</th><th>Saldo</th><th>A√ß√µes</th></tr></thead>
                            <tbody id="customerTableBody"></tbody>
                        </table></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="tab-pane fade" id="pills-estoque">
            <div class="row">
                <div class="col-md-4 mb-3">
                    <div class="card card-summary p-3 mb-3">
                        <h5>Novo Produto</h5>
                        <input type="text" id="prodName" class="form-control mb-2" placeholder="Nome">
                        <input type="number" id="prodPrice" class="form-control mb-2" placeholder="Pre√ßo">
                        <input type="number" id="prodStock" class="form-control mb-2" placeholder="Estoque">
                        <button onclick="addProduct()" class="btn btn-primary w-100">Salvar</button>
                    </div>
                    <div class="card card-summary p-3 bg-light text-center">
                        <label for="prodExcelInput" class="btn btn-sm btn-outline-success w-100">Importar Produtos (Excel)</label>
                        <input type="file" id="prodExcelInput" style="display:none" onchange="importProducts(this)">
                    </div>
                </div>
                <div class="col-md-8">
                    <div class="card card-summary p-3">
                        <div class="table-responsive"><table class="table align-middle">
                            <thead><tr><th>Item</th><th>Pre√ßo</th><th>Estoque</th><th class="text-end">A√ß√µes</th></tr></thead>
                            <tbody id="inventoryTableBody"></tbody>
                        </table></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="tab-pane fade" id="pills-config">
            <div class="row">
                <div class="col-md-6 mb-3">
                    <div class="card card-summary p-3">
                        <h5>Taxa do Cart√£o (%)</h5>
                        <div class="input-group mb-3">
                            <input type="number" id="cardFee" class="form-control" placeholder="Ex: 2.5">
                            <span class="input-group-text">%</span>
                        </div>
                        <button onclick="saveConfigs()" class="btn btn-primary">Salvar Taxa</button>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card card-summary p-3 text-center">
                        <h5>Imagem QR Code Pix</h5>
                        <input type="file" id="pixUpload" class="form-control mb-3" accept="image/*" onchange="previewPix(this)">
                        <div class="pix-preview">
                            <img id="pixDisplayImg" src="" alt="Pix">
                            <p id="pixPlaceholder" class="text-muted small m-0">Sem imagem</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="historyModal" tabindex="-1"><div class="modal-dialog"><div class="modal-content"><div class="modal-header bg-light"><h5>Extrato Detalhado</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div id="historyList"></div></div></div></div></div>
<div class="modal fade" id="pixModal" tabindex="-1"><div class="modal-dialog modal-sm modal-dialog-centered"><div class="modal-content text-center p-4"><h5>Pagamento Pix</h5><img id="pixModalImg" src="" class="img-fluid my-3 rounded"><button class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button></div></div></div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
    let products = JSON.parse(localStorage.getItem('cf_products')) || [];
    let customers = JSON.parse(localStorage.getItem('cf_customers')) || [];
    let config = JSON.parse(localStorage.getItem('cf_config')) || { cardFee: 0, pixImg: '' };
    let cart = [];
    let balanceFilter = 'all'; // 'all', 'negative', 'positive'

    function init() {
        document.getElementById('cardFee').value = config.cardFee;
        if(config.pixImg) {
            document.getElementById('pixDisplayImg').src = config.pixImg;
            document.getElementById('pixDisplayImg').style.display = 'block';
            document.getElementById('pixModalImg').src = config.pixImg;
            document.getElementById('pixPlaceholder').style.display = 'none';
        }
        renderProducts(); renderCustomers(); renderPOSProducts(); updateCustomerSelect();
    }

    function saveData() {
        localStorage.setItem('cf_products', JSON.stringify(products));
        localStorage.setItem('cf_customers', JSON.stringify(customers));
        localStorage.setItem('cf_config', JSON.stringify(config));
    }

    // --- FILTROS DE CLIENTE ---
    function setBalanceFilter(type) {
        balanceFilter = type;
        const labels = { 'all': '<i class="bi bi-funnel"></i> Todos', 'negative': '<i class="bi bi-dash-circle text-danger"></i> Devedores', 'positive': '<i class="bi bi-plus-circle text-success"></i> Positivos' };
        document.getElementById('activeFilterLabel').innerHTML = labels[type];
        renderCustomers();
    }

    function renderCustomers() {
        const search = document.getElementById('searchClient').value.toLowerCase();
        let filtered = customers.filter(c => c.name.toLowerCase().includes(search));

        if (balanceFilter === 'negative') filtered = filtered.filter(c => c.balance < 0);
        if (balanceFilter === 'positive') filtered = filtered.filter(c => c.balance > 0);

        document.getElementById('customerTableBody').innerHTML = filtered.map(c => `
            <tr><td><b>${c.name}</b><br><small class="text-muted">${c.phone || ''}</small></td>
            <td class="${c.balance>=0?'text-credit':'text-debt'}">R$ ${c.balance.toFixed(2)}</td>
            <td><button class="btn btn-sm btn-info" onclick="viewHist(${c.id})"><i class="bi bi-clock-history"></i></button>
            <button class="btn btn-sm btn-success" onclick="payDebt(${c.id})"><i class="bi bi-currency-dollar"></i></button>
            <button class="btn btn-sm btn-outline-danger" onclick="delCust(${c.id})"><i class="bi bi-trash"></i></button></td></tr>`).join('');
    }

    // --- BUSCA NO CARRINHO ---
    function filterCartCustomers() {
        const input = document.getElementById('customerSearchInput').value.toLowerCase();
        const select = document.getElementById('saleCustomer');
        const sorted = [...customers].sort((a,b) => a.name.localeCompare(b.name));
        select.innerHTML = '<option value="">Resultados...</option>' + 
            sorted.filter(c => c.name.toLowerCase().includes(input)).map(c => `<option value="${c.id}">${c.name}</option>`).join('');
        if(select.querySelectorAll('option').length === 2 && input !== "") select.selectedIndex = 1;
    }

    function syncSearchInput() {
        const select = document.getElementById('saleCustomer');
        if(select.value !== "") document.getElementById('customerSearchInput').value = select.options[select.selectedIndex].text;
    }

    // --- GEST√ÉO PRODUTOS ---
    function addProduct() {
        const name = document.getElementById('prodName').value;
        const price = parseFloat(document.getElementById('prodPrice').value);
        const stock = parseInt(document.getElementById('prodStock').value) || 0;
        if(!name || isNaN(price)) return alert("Dados inv√°lidos");
        products.push({id: Date.now(), name, price, stock});
        saveData(); renderProducts(); renderPOSProducts();
        document.getElementById('prodName').value = ''; document.getElementById('prodPrice').value = ''; document.getElementById('prodStock').value = '';
    }

    function renderProducts() {
        document.getElementById('inventoryTableBody').innerHTML = products.map((p, i) => `
            <tr><td>${p.name}</td><td>R$ ${p.price.toFixed(2)}</td><td><span class="badge ${p.stock < 5 ? 'bg-danger':'bg-secondary'}">${p.stock}</span></td>
            <td class="text-end"><button class="btn btn-sm btn-warning" onclick="editProd(${i})"><i class="bi bi-pencil"></i></button>
            <button class="btn btn-sm btn-danger" onclick="delProd(${i})"><i class="bi bi-trash"></i></button></td></tr>`).join('');
    }

    function editProd(i) {
        const p = products[i];
        const n = prompt("Nome:", p.name); const v = prompt("Pre√ßo:", p.price); const e = prompt("Estoque:", p.stock);
        if(n) p.name = n; if(!isNaN(parseFloat(v))) p.price = parseFloat(v); if(!isNaN(parseInt(e))) p.stock = parseInt(e);
        saveData(); renderProducts(); renderPOSProducts();
    }

    function delProd(i) { if(confirm("Apagar?")) { products.splice(i, 1); saveData(); renderProducts(); renderPOSProducts(); } }

    // --- GEST√ÉO CLIENTES ---
    function addCustomer(fromName = null) {
        const name = fromName || document.getElementById('newClientName').value;
        const phone = fromName ? '' : document.getElementById('newClientPhone').value;
        if(!name) return alert("Nome obrigat√≥rio");
        const newCust = {id: Date.now(), name, phone, balance: 0, history: []};
        customers.push(newCust);
        saveData(); renderCustomers(); updateCustomerSelect();
        document.getElementById('newClientName').value = ''; document.getElementById('newClientPhone').value = '';
        return newCust;
    }

    function delCust(id) { if(confirm("Apagar cliente?")) { customers = customers.filter(c => c.id !== id); saveData(); renderCustomers(); updateCustomerSelect(); } }

    // --- VENDA & CARRINHO ---
    function renderPOSProducts() {
        const s = document.getElementById('searchProduct').value.toLowerCase();
        document.getElementById('posProductList').innerHTML = products.filter(p => p.name.toLowerCase().includes(s)).map(p => `
            <div class="col-4"><div class="card product-card p-2 text-center" onclick="addCart(${p.id})">
            <div class="fw-bold small text-truncate">${p.name}</div><div class="text-success small">R$${p.price.toFixed(2)}</div></div></div>`).join('');
    }

    function addCart(id) {
        const p = products.find(i => i.id === id);
        if(p.stock <= 0) return alert("Sem estoque!");
        const item = cart.find(i => i.id === id);
        if(item) { if(item.qty < p.stock) item.qty++; } else cart.push({...p, qty: 1});
        renderCart();
    }

    function renderCart() {
        document.getElementById('cartTableBody').innerHTML = cart.map((i, idx) => `
            <tr><td>${i.name}</td><td>${i.qty}x</td><td>R$${(i.price*i.qty).toFixed(2)}</td>
            <td class="text-end"><i class="bi bi-dash-circle text-danger" style="cursor:pointer" onclick="remCart(${idx})"></i></td></tr>`).join('');
        updateTotalWithFees();
        document.getElementById('cartCount').innerText = cart.length;
    }

    function remCart(i) { cart.splice(i, 1); renderCart(); }

    function updateTotalWithFees() {
        const method = document.getElementById('paymentMethod').value;
        const totalBase = cart.reduce((a, b) => a + (b.price * b.qty), 0);
        let totalFinal = totalBase;
        document.getElementById('btnShowPix').style.display = (method === 'Pix') ? 'block' : 'none';
        document.getElementById('cashInputDiv').style.display = (method === 'Dinheiro') ? 'block' : 'none';
        if (method === 'Cart√£o' && config.cardFee > 0) {
            const fee = (totalBase * (config.cardFee / 100));
            totalFinal = totalBase + fee;
            document.getElementById('feeAlert').style.display = 'block';
            document.getElementById('feeAlert').innerText = `+ R$ ${fee.toFixed(2)} de taxa (${config.cardFee}%)`;
        } else { document.getElementById('feeAlert').style.display = 'none'; }
        document.getElementById('cartTotalDisplay').innerText = `R$ ${totalFinal.toFixed(2)}`;
        return totalFinal;
    }

    function finalizeSale() {
        const finalAmount = updateTotalWithFees();
        if(!cart.length) return alert("Carrinho vazio");
        const cid = document.getElementById('saleCustomer').value;
        if(!cid) return alert("Selecione o cliente");
        const cust = customers.find(c => c.id == cid);
        const method = document.getElementById('paymentMethod').value;
        const itemsSummary = cart.map(i => `${i.qty}x ${i.name}`).join(', ');
        cust.history.push({ date: new Date().toLocaleString(), type: 'Compra', items: itemsSummary, method: method, value: -finalAmount });
        if(method !== 'Fiado') {
            cust.history.push({ date: new Date().toLocaleString(), type: 'Pagamento Imediato', items: 'Referente √† compra', method: method, value: finalAmount });
        } else { cust.balance -= finalAmount; }
        if(method === 'Dinheiro') {
            const received = parseFloat(document.getElementById('cashReceived').value) || 0;
            const diff = received - finalAmount;
            if(diff > 0 && confirm(`Troco de R$${diff.toFixed(2)} vira cr√©dito?`)) {
                cust.balance += diff;
                cust.history.push({date: new Date().toLocaleString(), type: 'Cr√©dito (Troco)', value: diff, method: 'Dinheiro'});
            }
        }
        cart.forEach(c => { const p = products.find(x => x.id === c.id); if(p) p.stock -= c.qty; });
        cart = []; document.getElementById('customerSearchInput').value = '';
        saveData(); renderCart(); renderProducts(); renderCustomers(); renderPOSProducts(); updateCustomerSelect();
        alert("Venda registrada!");
    }

    // --- HIST√ìRICO ---
    function viewHist(id) {
        const c = customers.find(x => x.id === id);
        const list = document.getElementById('historyList');
        list.innerHTML = c.history.length === 0 ? "<p class='text-muted'>Vazio.</p>" : 
            c.history.slice().reverse().map(h => `
                <div class="hist-item ${h.value < 0 ? 'hist-buy' : 'hist-pay'} small">
                    <div class="d-flex justify-content-between"><b>${h.date}</b><span class="${h.value < 0 ? 'text-danger' : 'text-success'}">R$ ${Math.abs(h.value).toFixed(2)}</span></div>
                    <div>${h.type} (${h.method || 'N/A'})</div>
                    <div class="text-muted">${h.items || ''}</div>
                </div>`).join('');
        new bootstrap.Modal(document.getElementById('historyModal')).show();
    }

    function payDebt(id) {
        const c = customers.find(x => x.id === id);
        const v = prompt(`D√≠vida: R$${Math.abs(c.balance).toFixed(2)}\nValor pago:`);
        if(v) {
            const n = parseFloat(v.replace(',','.'));
            if(!isNaN(n)) {
                c.balance += n;
                c.history.push({ date: new Date().toLocaleString(), type: 'Pagamento de D√≠vida', value: n, method: 'Dinheiro/Pix' });
                saveData(); renderCustomers();
            }
        }
    }

    // --- QR E AUXILIARES ---
    let scanner;
    function startScanner(type) {
        const container = type === 'manual' ? 'reader' : 'readerCart';
        document.getElementById(container).style.display = 'block';
        scanner = new Html5Qrcode(container);
        scanner.start({ facingMode: "environment" }, { fps: 10, qrbox: 250 }, (txt) => {
            if(type === 'manual') document.getElementById('newClientName').value = txt;
            else { const newC = addCustomer(txt); document.getElementById('customerSearchInput').value = newC.name; updateCustomerSelect(); document.getElementById('saleCustomer').value = newC.id; }
            scanner.stop(); document.getElementById(container).style.display = 'none';
        }).catch(() => alert("C√¢mera bloqueada."));
    }

    function saveConfigs() { config.cardFee = parseFloat(document.getElementById('cardFee').value) || 0; saveData(); alert("Taxa salva!"); }
    
    function previewPix(input) {
        const file = input.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = (e) => {
                config.pixImg = e.target.result;
                document.getElementById('pixDisplayImg').src = e.target.result;
                document.getElementById('pixDisplayImg').style.display = 'block';
                document.getElementById('pixModalImg').src = e.target.result;
                document.getElementById('pixPlaceholder').style.display = 'none';
                saveData();
            };
            reader.readAsDataURL(file);
        }
    }

    function updateCustomerSelect() {
        const sel = document.getElementById('saleCustomer');
        const sorted = [...customers].sort((a,b) => a.name.localeCompare(b.name));
        sel.innerHTML = '<option value="">Selecionar Cliente...</option>' + sorted.map(c => `<option value="${c.id}">${c.name}</option>`).join('');
    }

    function importCustomers(input) {
        const reader = new FileReader();
        reader.onload = (e) => {
            const workbook = XLSX.read(new Uint8Array(e.target.result), {type: 'array'});
            const json = XLSX.utils.sheet_to_json(workbook.Sheets[workbook.SheetNames[0]]);
            json.forEach(row => { const name = row['Nome'] || row['nome']; if(name) customers.push({id: Date.now()+Math.random(), name, phone: row['Telefone']||'', balance: 0, history: []}); });
            saveData(); renderCustomers(); updateCustomerSelect(); alert("Importado!");
        };
        reader.readAsArrayBuffer(input.files[0]);
    }

    function importProducts(input) {
        const reader = new FileReader();
        reader.onload = (e) => {
            const workbook = XLSX.read(new Uint8Array(e.target.result), {type: 'array'});
            const json = XLSX.utils.sheet_to_json(workbook.Sheets[workbook.SheetNames[0]]);
            json.forEach(row => { const name = row['Nome'] || row['nome']; const price = parseFloat(row['Pre√ßo'] || row['preco'] || 0); if(name) products.push({id: Date.now()+Math.random(), name, price, stock: parseInt(row['Estoque']||0)}); });
            saveData(); renderProducts(); renderPOSProducts(); alert("Importado!");
        };
        reader.readAsArrayBuffer(input.files[0]);
    }

    function resetSystem() { if(confirm("Apagar tudo?")) { localStorage.clear(); location.reload(); } }
    init();
</script>
</body>
</html>

